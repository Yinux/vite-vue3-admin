!function(){var e=document.createElement("style");e.innerHTML="html.dark .split-wrapper{background-color:#000}html:not(.dark) .split-wrapper{background-color:#fff}html.dark .separator{background-color:#000;color:#000}html:not(.dark) .separator{background-color:#fff;color:#fff}.split-wrapper{display:flex;width:100%;height:100%}.split-wrapper .scalable{position:relative;width:240px;max-width:50vw;min-width:100px;overflow:auto}.split-wrapper .scalable .left-content{height:100%;padding:12px 20px 12px 12px}.split-wrapper .scalable .separator{position:absolute;top:0;right:0;display:flex;width:14px;height:100%;cursor:col-resize;box-shadow:-4px -2px 4px -5px #00000059,4px 3px 4px -5px #00000059;align-items:center;justify-content:center}.split-wrapper .scalable .separator i{width:1px;height:14px;margin:0 1px;background-color:#e9e9e9}.split-wrapper .right-content{flex:1}.split-wrapper .left-content,.split-wrapper .right-content{overflow:auto}\n",document.head.appendChild(e),System.register(["./index-legacy.10faf772.js","./index-legacy.507b014e.js","./dynamic-table-legacy.a396125d.js","./useFormModal-legacy.c37dd9fe.js","./utils-legacy.76523550.js","./index-legacy.63d24141.js","./pick-legacy.9237dedd.js","./index-legacy.7d7cea3a.js","./PlusOutlined-legacy.18137da5.js","./css-legacy.afbdb071.js","./schema-form-legacy.fa1ba664.js","./index-legacy.3af98c48.js","./index-legacy.eb8104e3.js","./zh_CN-legacy.96420b0d.js"],(function(e){"use strict";var t,n,a,l,r,o,c,s,d,i,u,p,m,f,y,h,b,v,w,g,x,I,P,O,j,k,S,C,E,_,K,D,M,A,z,N,T,L,R,$,q,F,H;return{setters:[function(e){t=e.g,n=e.u,a=e.c,l=e.t,r=e.d,o=e.a},function(e){c=e.c,s=e.A,d=e.aL,i=e.aC,u=e.bz,p=e.aJ,m=e.d,f=e.j,y=e.bA,h=e.I,b=e.J,v=e.O,w=e.ap,g=e.a4,x=e.bB,I=e.bC,P=e.r,O=e.m,j=e.U,k=e.V,S=e.a3,C=e.W,E=e.at,_=e.ac,K=e.a5,D=e.bD,M=e.aN,A=e.aM,z=e.bE},function(e){N=e.u},function(e){T=e.u},function(e){L=e.f,R=e.a},function(e){$=e.D},function(e){q=e.M},function(e){F=e.A},function(e){H=e.P},function(){},function(){},function(){},function(){},function(){}],execute:function(){var V={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"}}]},name:"delete",theme:"outlined"};function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?Object(arguments[t]):{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){W(e,t,n[t])}))}return e}function W(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var U=function(e,t){var n=B({},e,t.attrs);return c(s,B({},n,{icon:V}),null)};U.displayName="DeleteOutlined",U.inheritAttrs=!1;var J=U,X={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"}}]},name:"edit",theme:"outlined"};function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?Object(arguments[t]):{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){Q(e,t,n[t])}))}return e}function Q(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Y=function(e,t){var n=G({},e,t.attrs);return c(s,G({},n,{icon:X}),null)};Y.displayName="EditOutlined",Y.inheritAttrs=!1;var Z=Y,ee={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M847.9 592H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h605.2L612.9 851c-4.1 5.2-.4 13 6.3 13h72.5c4.9 0 9.5-2.2 12.6-6.1l168.8-214.1c16.5-21 1.6-51.8-25.2-51.8zM872 356H266.8l144.3-183c4.1-5.2.4-13-6.3-13h-72.5c-4.9 0-9.5 2.2-12.6 6.1L150.9 380.2c-16.5 21-1.6 51.8 25.1 51.8h696c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"swap",theme:"outlined"};function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?Object(arguments[t]):{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){ne(e,t,n[t])}))}return e}function ne(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ae=function(e,t){var n=te({},e,t.attrs);return c(s,te({},n,{icon:ee}),null)};ae.displayName="SwapOutlined",ae.inheritAttrs=!1;var le=ae,re={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M168 504.2c1-43.7 10-86.1 26.9-126 17.3-41 42.1-77.7 73.7-109.4S337 212.3 378 195c42.4-17.9 87.4-27 133.9-27s91.5 9.1 133.8 27A341.5 341.5 0 01755 268.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.7 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c0-6.7-7.7-10.5-12.9-6.3l-56.4 44.1C765.8 155.1 646.2 92 511.8 92 282.7 92 96.3 275.6 92 503.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8zm756 7.8h-60c-4.4 0-7.9 3.5-8 7.8-1 43.7-10 86.1-26.9 126-17.3 41-42.1 77.8-73.7 109.4A342.45 342.45 0 01512.1 856a342.24 342.24 0 01-243.2-100.8c-9.9-9.9-19.2-20.4-27.8-31.4l60.2-47a8 8 0 00-3-14.1l-175.7-43c-5-1.2-9.9 2.6-9.9 7.7l-.7 181c0 6.7 7.7 10.5 12.9 6.3l56.4-44.1C258.2 868.9 377.8 932 512.2 932c229.2 0 415.5-183.7 419.8-411.8a8 8 0 00-8-8.2z"}}]},name:"sync",theme:"outlined"};function oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?Object(arguments[t]):{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){ce(e,t,n[t])}))}return e}function ce(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var se=function(e,t){var n=oe({},e,t.attrs);return c(s,oe({},n,{icon:re}),null)};se.displayName="SyncOutlined",se.inheritAttrs=!1;var de=se;const ie=[{field:"name",component:"Input",label:"部门名称",rules:[{required:!0,type:"string"}]},{field:"parentId",component:"TreeSelect",label:"上级部门",componentProps:{getPopupContainer:()=>document.body},rules:[{required:!0,type:"number"}]},{field:"orderNum",component:"InputNumber",label:"排序号",defaultValue:255,componentProps:{style:{width:"100%"}}}],ue=[{field:"departmentId",component:"TreeSelect",label:"所属部门",componentProps:{getPopupContainer:()=>document.body},rules:[{required:!0,type:"number"}]},{field:"roles",component:"Select",label:"所属角色",rules:[{required:!0,type:"array"}],componentProps:{mode:"multiple",request:async()=>(await t()).map((e=>({label:e.name,value:e.id})))}},{field:"username",component:"Input",label:"用户名",rules:[{required:!0}]},{field:"name",component:"Input",label:"姓名",colProps:{span:12},rules:[{required:!0}]},{field:"nickName",component:"Input",label:"呢称",colProps:{span:12}},{field:"email",component:"Input",label:"邮箱",colProps:{span:12}},{field:"phone",component:"Input",label:"手机",colProps:{span:12}},{field:"remark",component:"InputTextArea",label:"备注"},{field:"status",component:"RadioGroup",label:"状态",defaultValue:1,componentProps:{options:[{label:"启用",value:1},{label:"禁用",value:0}]}}],pe=[{field:"password",component:"Input",label:"新密码",rules:[{required:!0,type:"string"}]}],me=[{field:"departmentId",component:"TreeSelect",label:"转移至",rules:[{required:!0,type:"number"}]}];function fe(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!u(e)}const ye=[{title:"头像",width:80,dataIndex:"headImg",hideInSearch:!0,bodyCell:({record:e})=>c(d,{src:e.headImg},null)},{title:"姓名",width:120,dataIndex:"name",align:"center"},{title:"用户名",width:120,align:"center",dataIndex:"username"},{title:"所在部门",dataIndex:"departmentName",hideInSearch:!0,align:"center",width:180},{title:"所属角色",dataIndex:"roleNames",align:"center",hideInSearch:!0,width:220,customRender:({text:e})=>{let t;return c(p,null,fe(t=e.map((e=>c(i,{color:"success",key:e},fe(e)?e:{default:()=>[e]}))))?t:{default:()=>[t]})}},{title:"呢称",width:120,align:"center",dataIndex:"nickName"},{title:"邮箱",width:120,align:"center",dataIndex:"email"},{title:"手机",width:120,align:"center",dataIndex:"phone"},{title:"备注",width:120,align:"center",dataIndex:"remark"},{title:"状态",dataIndex:"status",width:100,formItemProps:{component:"Select",componentProps:{options:[{label:"启用",value:1},{label:"禁用",value:0}]}},bodyCell:({record:e})=>{const t=1===e.status;return c(i,{color:t?"success":"red"},{default:()=>[t?"启用":"禁用"]})}},{title:"创建时间",dataIndex:"createdAt",width:120,formItemProps:{component:"DatePicker",componentProps:{class:"w-full"}}},{title:"修改时间",dataIndex:"updatedAt",width:120,formItemProps:{component:"DatePicker",componentProps:{class:"w-full"}}}];const he={class:"split-wrapper"},be={class:"left-content"},ve=g(" 右边内容区 "),we=[v("i",null,null,-1),v("i",null,null,-1)],ge={class:"right-content"},xe=g(" 右边内容区 ");var Ie=m({__name:"index",setup(e){const t=f();let n,a;const l=y((function(e){t.value&&(t.value.style.width=a+e.clientX-n+"px")}),20),r=()=>{document.documentElement.style.userSelect="unset",document.documentElement.removeEventListener("mousemove",l),document.documentElement.removeEventListener("mouseup",r)},o=e=>{n=e.clientX,t.value&&(a=parseInt(window.getComputedStyle(t.value).width,10)),document.documentElement.style.userSelect="none",document.documentElement.addEventListener("mousemove",l),document.documentElement.addEventListener("mouseup",r)};return(e,n)=>(h(),b("div",he,[v("div",{ref_key:"scalable",ref:t,class:"scalable"},[v("div",be,[w(e.$slots,"left-content",{},(()=>[ve]))]),v("div",{ref:"separator",class:"separator",onMousedown:o},we,544)],512),v("div",ge,[w(e.$slots,"right-content",{},(()=>[xe]))])]))}});function Pe(e){return x({url:I.add,method:"post",data:e},{successMsg:"创建用户成功"})}function Oe(e){return x({url:I.update,method:"post",data:e},{successMsg:"修改用户成功"})}function je(e){return x({url:I.delete,method:"post",data:e})}const ke={class:"flex justify-between"},Se=v("div",null,"组织架构",-1),Ce=g("新增部门 "),Ee=g("刷新 "),_e=g(" 编辑 "),Ke=g(" 删除 "),De=g("取消选择"),Me=g(" 新增 "),Ae=g(" 转移 "),ze=g(" 删除 ");e("default",m({name:"SystemUser",setup(e){const[t,s]=N(),[d]=T(),i=f(!1),u=P({expandedKeys:[],departmentIds:[],deptTree:[]}),m=f({selectedRowKeys:[],onChange:(e,t)=>{console.log(`selectedRowKeys: ${e}`,"selectedRows: ",t),m.value.selectedRowKeys=e}}),y=O((()=>m.value.selectedRowKeys.length)),b=async(e={})=>{var t;console.log("record",e);const[l]=await d({modalProps:{title:(e.id?"编辑":"新增")+"部门",width:700,onFinish:async t=>{console.log("新增/编辑部门",t),t.id=e.id,await(e.id?n:a)(t),W()}},formProps:{labelWidth:100,schemas:ie}});null==l||l.updateSchema([{field:"parentId",componentProps:{treeDefaultExpandedKeys:[-1].concat((null==e?void 0:e.keyPath)||[]),treeData:[{value:-1,title:"#",children:u.deptTree}]}}]),null==l||l.setFieldsValue({...e,parentId:null!==(t=e.parentId)&&void 0!==t?t:-1})},w=async()=>{const[e]=await d({modalProps:{title:"转移部门",width:700,onFinish:async e=>{await l({departmentId:e.departmentId,userIds:m.value.selectedRowKeys.map((e=>e))})}},formProps:{labelWidth:100,schemas:me}});null==e||e.updateSchema([{field:"departmentId",componentProps:{treeData:u.deptTree}}])},V=async(e={})=>{var t;const[n]=await d({modalProps:{title:(e.id?"编辑":"新增")+"用户",width:700,onFinish:async t=>{console.log("新增/编辑用户",t),t.id=e.id,await(e.id?Oe:Pe)(t),null==s||s.reload()}},formProps:{labelWidth:100,schemas:ue}});if(null==n||n.updateSchema([{field:"departmentId",componentProps:{treeDefaultExpandedKeys:(null===(t=L(null==e?void 0:e.departmentId,u.deptTree))||void 0===t?void 0:t.keyPath)||[],treeData:u.deptTree}}]),null==n||n.setFieldsValue(e),null!=e&&e.id){const{roles:t}=await(a={userId:e.id},x({url:I.info,method:"get",params:a}));null==n||n.setFieldsValue({roles:t})}var a},B=async e=>{await d({modalProps:{title:`修改密码(${e.username})`,width:700,onFinish:async t=>{var n;await(n={userId:e.id,password:t.password},x({url:I.password,method:"post",data:n},{successMsg:"操作成功"}))}},formProps:{labelWidth:100,schemas:pe}})},W=async()=>{i.value=!0;const e=await o().finally((()=>i.value=!1));u.deptTree=R(e),u.expandedKeys=[...u.expandedKeys,...u.deptTree.map((e=>Number(e.key)))]};W();const U=async e=>{Array.isArray(e)?A.confirm({title:"确定要删除所选的用户吗?",icon:c(z,null,null),centered:!0,onOk:async()=>{await je({userIds:e}),W()}}):await je({userIds:[e]}).finally(null==s?void 0:s.reload)},X=e=>{var t;u.departmentIds=e,null==s||null===(t=s.reload)||void 0===t||t.call(s)},G=async({page:e,limit:t})=>{const n=await function(e){return x({url:I.page,method:"post",data:e})}({page:e,limit:t,departmentIds:u.departmentIds.length?u.departmentIds:void 0});return m.value.selectedRowKeys=[],n},Q=[...ye,{title:"操作",width:230,dataIndex:"$action",align:"center",fixed:"right",actions:({record:e})=>[{label:"编辑",auth:{perm:"sys.user.update",effect:"disable"},onClick:()=>V(e)},{label:"改密",auth:"sys.user.password",onClick:()=>B(e)},{label:"删除",auth:"sys.user.delete",popConfirm:{title:"你确定要删除吗？",onConfirm:()=>U(e.id)}}]}];return(e,n)=>{const a=j("a-button");return h(),k(C(Ie),null,{"left-content":S((()=>[v("div",ke,[Se,c(C(p),null,{default:S((()=>[e.$auth("sys.dept.add")?(h(),k(C(E),{key:0,placement:"top"},{title:S((()=>[Ce])),default:S((()=>[c(C(H),{onClick:n[0]||(n[0]=e=>b({}))})])),_:1})):_("",!0),c(C(E),{placement:"top"},{title:S((()=>[Ee])),default:S((()=>[c(C(de),{spin:i.value,onClick:W},null,8,["spin"])])),_:1})])),_:1})]),c(C(D),{expandedKeys:u.expandedKeys,"onUpdate:expandedKeys":n[1]||(n[1]=e=>u.expandedKeys=e),"auto-expand-parent":"","tree-data":u.deptTree,onSelect:X},{title:S((({key:t,title:n,formData:a})=>[c(C($),{trigger:["contextmenu"]},{overlay:S((()=>[c(C(q),null,{default:S((()=>[c(C(q).Item,{key:"1",disabled:!e.$auth("sys.dept.update"),onClick:e=>b(a)},{default:S((()=>[_e,c(C(Z))])),_:2},1032,["disabled","onClick"]),c(C(q).Item,{key:"2",disabled:!e.$auth("sys.dept.delete"),onClick:e=>{return n=t,void A.confirm({title:"确定要删除该部门吗?",icon:c(z,null,null),centered:!0,onOk:async()=>{await r({departmentId:n}),W()}});var n}},{default:S((()=>[Ke,c(C(J))])),_:2},1032,["disabled","onClick"])])),_:2},1024)])),default:S((()=>[v("span",null,K(n),1)])),_:2},1024)])),_:1},8,["expandedKeys","tree-data"])])),"right-content":S((()=>[c(C(t),{"header-title":"用户管理","show-index":"","title-tooltip":"请不要随意删除用户，避免到影响其他用户的使用。","data-request":G,columns:Q,scroll:{x:2e3},"row-selection":m.value},M({toolbar:S((()=>[c(a,{type:"primary",disabled:!e.$auth("sys.user.add"),onClick:n[3]||(n[3]=e=>V({}))},{default:S((()=>[c(C(H)),Me])),_:1},8,["disabled"]),c(a,{type:"success",disabled:!C(y)||!e.$auth("sys.dept.transfer"),onClick:w},{default:S((()=>[c(C(le)),Ae])),_:1},8,["disabled"]),c(a,{type:"danger",disabled:!C(y)||!e.$auth("sys.user.delete"),onClick:n[4]||(n[4]=e=>U(m.value.selectedRowKeys))},{default:S((()=>[c(C(J)),ze])),_:1},8,["disabled"])])),_:2},[C(y)?{name:"title",fn:S((()=>[c(C(F),{class:"w-full",type:"info","show-icon":""},{message:S((()=>[g(" 已选 "+K(C(y))+" 项 ",1),c(a,{type:"link",onClick:n[2]||(n[2]=e=>m.value.selectedRowKeys=[])},{default:S((()=>[De])),_:1})])),_:1})]))}:void 0]),1032,["row-selection"])])),_:1})}}}))}}}))}();
